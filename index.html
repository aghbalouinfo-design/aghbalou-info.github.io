<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS-Lycee</title>

    <!-- CONFIGURATION DU FAVICON (maintenue) -->
    <link rel="icon" type="image/png" href="https://aghbalouinfo-design.github.io/aghbalou-info.github.io/cyberpunk-me.png">
    <link rel="apple-touch-icon" href="https://aghbalouinfo-design.github.io/aghbalou-info.github.io/cyberpunk-me.png">
    
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Importation de la police Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Fond très léger, harmonieux */
        }

        /* --- Couleurs de Thème et de Module (Vives) --- */
        /* Couleur de Marque (Navigation/Accentuation) */
        .gradient-theme {
            /* Dégradé Vert-Bleu (Teal Vif vers Cyan Profond) */
            background-image: linear-gradient(to right, #20c997, #17a2b8); 
        }

        /* Couleurs Primaires pour chaque Module */
        .bg-module-m01 { background-image: linear-gradient(to right, #2563eb, #3b82f6); } /* Bleu Vif */
        .bg-module-m02 { background-image: linear-gradient(to right, #059669, #10b981); } /* Vert Émeraude */
        .bg-module-m03 { background-image: linear-gradient(to right, #4f46e5, #6366f1); } /* Indigo Profond */
        .bg-module-m04 { background-image: linear-gradient(to right, #dc2626, #ef4444); } /* Rouge Alerte/Archive */


        /* --- Hiérarchie Visuelle (Opacité et Estompage) --- */
        .module-card-active {
            opacity: 1; /* En cours */
        }
        .module-card-completed {
            opacity: 0.75; /* Terminé/Archivé */
        }
        .module-card-upcoming {
            opacity: 0.60; /* À venir (grisé) */
            filter: grayscale(20%); /* Léger grisonnement */
        }


        /* --- Effets Généraux --- */
        .module-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, opacity 0.3s;
        }

        .module-card:hover:not(.module-card-upcoming) {
            transform: translateY(-4px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
            opacity: 1 !important; /* L'opacité remonte au survol */
        }
        .module-card:hover.module-card-upcoming {
             box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        /* Amélioration Mobile */
        @media (max-width: 768px) {
            .nav-links li a {
                padding: 10px 12px;
                font-size: 1rem;
            }
            .info-card {
                margin-bottom: 24px;
            }
            .sequence-heading {
                font-size: 1.25rem;
            }
        }
        
        /* Accordéon des modules */
        .card-body {
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
            padding-top: 16px; 
        }

        .collapsed .card-body {
            max-height: 0;
            padding-top: 0;
        }

        /* Style pour les sections de la page de leçon */
        .lesson-section {
            border-left: 4px solid #17a2b8;
            padding-left: 1.5rem;
            margin-bottom: 2rem;
        }
        .lesson-section h3 {
            color: #17a2b8;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }

        /* --- Styles pour les NOTES DÉTAILLÉES --- */

        /* Cacher le marqueur natif */
        details summary {
            list-style: none;
        }
        details summary::-webkit-details-marker {
            display: none;
        }
        
        /* Rotation de l'icône pour la section DÉTAILS */
        .notes-summary-icon {
            /* Commence par pointer vers la droite (fermée) */
            transform: rotate(-90deg); 
            transition: transform 0.3s ease;
        }

        details[open] .notes-summary-icon {
            /* Pointe vers le bas (ouverte) */
            transform: rotate(0deg); 
        }

        /* Style Modal (Maintenue pour la réutilisation mais cachée pour la Leçon 1) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }
        .modal-content {
            background-color: white;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            border-radius: 1rem;
            position: relative;
        }
        
    </style>
</head>
<body>

    <!-- Conteneur principal -->
    <div id="app" class="min-h-screen">
        
        <!-- Navigation -->
       <nav class="bg-white shadow-md sticky top-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <a href="#" onclick="navigateTo('accueil')" class="flex-shrink-0 text-2xl font-bold gradient-theme bg-clip-text text-transparent">
                        Info-Aghbalou
                    </a>

                    <div class="hidden md:flex space-x-4 nav-links">
                        <a href="#" onclick="navigateTo('accueil')" class="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md font-medium" id="nav-accueil">Accueil</a>
                        <a href="#" onclick="navigateTo('modules')" class="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md font-medium" id="nav-modules">Modules</a>
                        <a href="#" onclick="navigateTo('ressources')" class="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md font-medium" id="nav-ressources">Ressources</a>
                        <a href="#" onclick="navigateTo('calendrier')" class="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md font-medium" id="nav-calendrier">Calendrier</a>
                        <a href="#" onclick="navigateTo('devoirs')" class="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md font-medium" id="nav-devoirs">Devoirs</a>
                        <a href="#" onclick="navigateTo('contact')" class="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md font-medium" id="nav-contact">Contact</a>
                    </div>
                    
                    <div class="md:hidden flex items-center">
                        <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-teal-500" aria-controls="mobile-menu" aria-expanded="false">
                            <span class="sr-only">Ouvrir le menu principal</span>
                            <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                            <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>

                </div>
            </div>

            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#" onclick="mobileNavigateTo('accueil')" class="text-gray-700 hover:bg-gray-50 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium" id="mobile-nav-accueil">Accueil</a>
                    <a href="#" onclick="mobileNavigateTo('modules')" class="text-gray-700 hover:bg-gray-50 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium" id="mobile-nav-modules">Modules</a>
                    <a href="#" onclick="mobileNavigateTo('ressources')" class="text-gray-700 hover:bg-gray-50 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium" id="mobile-nav-ressources">Ressources</a>
                    <a href="#" onclick="mobileNavigateTo('calendrier')" class="text-gray-700 hover:bg-gray-50 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium" id="mobile-nav-calendrier">Calendrier</a>
                    <a href="#" onclick="mobileNavigateTo('devoirs')" class="text-gray-700 hover:bg-gray-50 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium" id="mobile-nav-devoirs">Devoirs</a>
                    <a href="#" onclick="mobileNavigateTo('contact')" class="text-gray-700 hover:bg-gray-50 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium" id="mobile-nav-contact">Contact</a>
                </div>
            </div>
        </nav>
        
        <!-- Contenu de la Page -->
        <main class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8" id="page-content-container">
            <!-- Le contenu de la page sera injecté ici par JavaScript -->
        </main>

        <!-- Modale de Carte Mentale (Maintenue pour la réutilisation mais cachée pour la Leçon 1) -->
        <div id="mindmap-modal" class="modal-overlay hidden" onclick="closeMindMap()">
            <div class="modal-content p-8 w-11/12 md:w-3/4 lg:w-2/3" onclick="event.stopPropagation()">
                <button onclick="closeMindMap()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl font-bold">
                    &times;
                </button>
                <div id="mindmap-content">
                    <!-- Le contenu de la carte mentale interne sera injecté ici -->
                    <p class="text-center text-gray-500">Contenu de la carte mentale interne.</p>
                </div>
            </div>
        </div>



        <!-- Footer -->
        <footer class="bg-gray-100 mt-12 py-6 text-center text-gray-600 text-sm">
            <p>&copy; 2024 Hub Pédagogique Informatique. Développé par <span class="font-bold">Younes TICHOUA</span>.</p>
            <p>Version 3.1 | <a href="#" onclick="navigateTo('accueil')" class="text-teal-600 hover:text-teal-800">Retour à l'accueil</a></p>
        </footer>
    </div>

    <!-- Script JavaScript -->
    <script>
        // Global
        let currentView = 'accueil';

        // Variables Firestore (même si non utilisées dans ce fichier, elles doivent être définies)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        
        // URL EXTERNE POUR LA CARTE MENTALE DE LA LEÇON 1
        const EXTERNAL_MINDMAP_URL = 'https://aghbalouinfo-design.github.io/aghbalou-info.github.io/Mindmap.html';
        // URL de la photo de l'enseignant, utilisée dans la page Contact
        const TEACHER_PHOTO_URL = 'https://aghbalouinfo-design.github.io/aghbalou-info.github.io/cyberpunk-me.png';


        // Icônes SVG pour les ressources
        const icons = {
            document: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm5 2a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1zm1 3a1 1 0 00-1 1v5a1 1 0 102 0v-5a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>`,
            video: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" viewBox="0 0 20 20" fill="currentColor"><path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0115 8v4a1 1 0 01-.447.894L11 15.618V6.382l3.553.724z" /></svg>`,
            app: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" viewBox="0 0 20 20" fill="currentColor"><path d="M10 2a6 6 0 00-6 6v2a1 1 0 001 1h6a1 1 0 001-1V8a6 6 0 00-6-6zM4 14v1a3 3 0 003 3h6a3 3 0 003-3v-1a1 1 0 00-1-1H5a1 1 0 00-1 1z" /></svg>`,
            pdf: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-600" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 10a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm0-3a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm0-3a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1z" clip-rule="evenodd" /></svg>`,
            // Caret pour les accordéons (pointe vers le bas)
            caret: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>`,
            // COCHE VERTE DE SUCCÈS pour les modules terminés
            checkPro: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>`,
        };

//------>>>>>>>ADD HERE<<<<<<<<<<----------///
        // --- Données Structurées des Leçons (avec Ressources et MindMap) ---
        const lessonData = {
            'M1-sequence01-L1': {
    title: "Leçon 1 : Information, traitement et Informatique",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",
    
    // ✅ OVERVIEW AMÉLIORÉ
    overview: "Cette leçon introduit les concepts fondamentaux de l'informatique : la distinction entre donnée, information et connaissance, le rôle du traitement dans la transformation des données, et le modèle IPO (Entrée – Traitement – Sortie). Elle se termine par une définition claire de l'informatique comme science du traitement automatique de l'information.",
    
    objectives: [
        "Distinguer les notions de donnée, information et connaissance, et comprendre leurs relations",
        "Expliquer la notion de traitement et le cycle IPO",
        "Définir le terme « informatique »"
    ],
    successCriteria: [
        "Je peux donner un exemple de donnée et le transformer en information.",
        "Je peux décrire Entrée – Traitement – Sortie pour un cas réel.",
        "Je peux expliquer ce que signifie automatique et définir l’informatique simplement"
    ],

    // ✅ NOTES DE COURS DÉTAILLÉES (complètes et sans digitalisation)
    detailedNotes: `
        <h4 class="text-xl font-bold text-teal-800 mb-3">1. Donnée, Information et Connaissance</h4>
        <p class="mb-4 text-gray-700">Ces trois notions sont essentielles pour comprendre le rôle de l'informatique :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Donnée :</strong> Élément brut, sans contexte (ex : 42, "Paris").</li>
            <li><strong>Information :</strong> Donnée interprétée avec un sens (ex : "42°C" = température).</li>
            <li><strong>Connaissance :</strong> Information intégrée et utilisée pour la prise de décision.</li>
        </ul>
        <p class="mb-4 text-gray-700"><em>Exemple :</em> "150" est une donnée. "150 km/h" est une information. Savoir que c'est une vitesse excessive sur route devient une connaissance.</p>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">2. Le Cycle IPO (Input-Process-Output)</h4>
        <p class="mb-4 text-gray-700">Le modèle IPO décrit le fonctionnement de tout système informatique :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Entrée (Input) :</strong> Les données brutes saisies (texte, clics, image).</li>
            <li><strong>Traitement (Process) :</strong> Application d'algorithmes par le CPU pour transformer les données.</li>
            <li><strong>Sortie (Output) :</strong> Résultat utilisable : une information (graphique, son, document).</li>
        </ul>
        <p class="mb-4 text-gray-700"><em>Exemple :</em> Entrée : chiffres de ventes → Traitement : calcul des totaux → Sortie : tableau récapitulatif.</p>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">3. Informatique et Automatisation</h4>
        <p class="mb-4 text-gray-700">L'informatique est la science du traitement automatique de l'information :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Automatique :</strong> Sans intervention humaine directe pendant le processus.</li>
            <li><strong>Objectif :</strong> Transformer des données en informations utiles pour la décision ou l'action.</li>
        </ul>
        <p class="mb-4 text-gray-700"><em>Définition simple :</em> L'informatique consiste à utiliser des machines pour traiter des données et produire des informations de manière rapide et fiable.</p>
    `,

    // ✅ RESSOURCES ET ACTIVITÉS
    resourcesAndActivities: [
        { type: "Worksheet", title: "Fiche : Donnée vs Information vs Connaissance", objective: "Clarifier les concepts", link: "fiche_concepts_L1.pdf", icon: "document" },
        { type: "Exercice", title: "Cas pratique : Identifier Entrée, Traitement, Sortie", objective: "Application du cycle IPO", link: "exercice_IPO_L1.pdf", icon: "document" },
        { type: "Tuto Vidéo", title: "Comprendre le cycle IPO en 5 min", objective: "Visualisation du processus", link: "video_cycle_IPO_L1.mp4", icon: "video" },
        { type: "Application", title: "Quiz interactif (App Web)", objective: "Auto-évaluation", link: "#", icon: "app" }
    ],

    // ✅ QUIZ
    quiz: [
        { id: 1, question: "Quelle est la différence entre donnée et information ?", options: ["Aucune", "La donnée est brute, l'information est interprétée", "L'information est toujours numérique"], answer: "La donnée est brute, l'information est interprétée", explanation: "Une donnée seule n'a pas de sens, elle devient information lorsqu'elle est contextualisée." },
        { id: 2, question: "Que signifie IPO ?", options: ["Input-Process-Output", "Information-Programme-Ordre", "Initialisation-Procédure-Opération"], answer: "Input-Process-Output", explanation: "C'est le modèle de base du traitement informatique." },
        { id: 3, question: "Vrai ou Faux : L'informatique est le traitement manuel de l'information.", answer: "Faux", explanation: "L'informatique implique un traitement automatique, sans intervention humaine directe." }
    ],

    koLink: { 
        url: "https://example.com/ko_m01_l01.pdf", 
        label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" 
    },
    mindMapUrl: EXTERNAL_MINDMAP_URL
},
            
            // Autres leçons simplifiées
            'M1-sequence01-L2': {
    title: "Leçon 2 : Système informatique, Représentation de l'information",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",

    // ✅ OVERVIEW AMÉLIORÉ
    overview: "Cette leçon explique comment l'information est représentée dans un système informatique. Nous abordons le rôle du système binaire, les conversions entre binaire et décimal, la notion de taille des fichiers numériques, et la distinction entre matériel (hardware) et logiciel (software).",

    objectives: [
        "Expliquer la notion de représentation de l’information et pourquoi on utilise le binaire en informatique",
        "Effectuer des conversions binaire → décimal et décimal → binaire",
        "Identifier la taille approximative de fichiers numériques courants et comparer leur taille",
        "Distinguer le hardware du software"
    ],

    successCriteria: [
        "Je peux expliquer pourquoi les ordinateurs utilisent le binaire",
        "Je peux convertir un nombre décimal en binaire et inversement",
        "Je peux estimer la taille d’un fichier texte, image ou audio",
        "Je peux donner des exemples de hardware et de software"
    ],

    // ✅ NOTES DE COURS DÉTAILLÉES
    detailedNotes: `
        <h4 class="text-xl font-bold text-teal-800 mb-3">1. Représentation de l'information en informatique</h4>
        <p class="mb-4 text-gray-700">Un ordinateur ne comprend que deux états : activé (1) ou désactivé (0). C'est pourquoi il utilise le système binaire pour représenter toute information.</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Binaire :</strong> Base 2 (0 et 1), chaque chiffre est un bit.</li>
            <li><strong>Pourquoi binaire ?</strong> Simplicité électronique (circuits ouverts/fermés).</li>
        </ul>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">2. Conversion binaire ↔ décimal</h4>
        <p class="mb-4 text-gray-700">Pour comprendre la représentation, il faut savoir convertir :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Décimal → Binaire :</strong> Division par 2 et récupération des restes.</li>
            <li><strong>Binaire → Décimal :</strong> Somme des puissances de 2 pour chaque bit à 1.</li>
        </ul>
        <p class="mb-4 text-gray-700"><em>Exemple :</em> 13 en binaire = 1101 ; 1101 en décimal = 13.</p>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">3. Taille des fichiers numériques</h4>
        <p class="mb-4 text-gray-700">La taille dépend du type de contenu :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Texte :</strong> Quelques Ko (ex : 1 page ≈ 2 Ko).</li>
            <li><strong>Image :</strong> De centaines de Ko à plusieurs Mo.</li>
            <li><strong>Audio :</strong> Plusieurs Mo (ex : 3 min MP3 ≈ 3 Mo).</li>
        </ul>
        <p class="mb-4 text-gray-700">Un fichier est mesuré en octets (1 octet = 8 bits). Les unités : Ko, Mo, Go.</p>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">4. Hardware vs Software</h4>
        <p class="mb-4 text-gray-700">Un système informatique est composé de :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Hardware :</strong> Composants physiques (CPU, RAM, disque dur, clavier).</li>
            <li><strong>Software :</strong> Programmes et systèmes (OS, applications).</li>
        </ul>
        <p class="mb-4 text-gray-700"><em>Exemple :</em> Windows = software ; Disque dur = hardware.</p>
    `,

    // ✅ RESSOURCES ET ACTIVITÉS
    resourcesAndActivities: [
        { type: "Worksheet", title: "Fiche : Pourquoi le binaire ?", objective: "Compréhension du système binaire", link: "fiche_binaire_L2.pdf", icon: "document" },
        { type: "Exercice", title: "Conversions binaire ↔ décimal", objective: "Application pratique", link: "exercice_conversion_L2.pdf", icon: "document" },
        { type: "Tuto Vidéo", title: "Comprendre hardware vs software", objective: "Distinction claire", link: "video_hardware_software_L2.mp4", icon: "video" },
        { type: "Application", title: "Simulateur de conversion binaire", objective: "Pratique interactive", link: "#", icon: "app" }
    ],

    // ✅ QUIZ
    quiz: [
        { id: 1, question: "Pourquoi les ordinateurs utilisent-ils le binaire ?", options: ["Parce que c'est plus rapide", "Parce que les circuits électroniques ont deux états", "Parce que c'est plus simple à lire"], answer: "Parce que les circuits électroniques ont deux états", explanation: "Les ordinateurs fonctionnent avec des signaux électriques : ouvert (0) ou fermé (1)." },
        { id: 2, question: "Combien de bits dans un octet ?", options: ["4", "8", "16"], answer: "8", explanation: "Un octet est composé de 8 bits." },
        { id: 3, question: "Donnez un exemple de hardware :", options: ["Windows", "Clavier", "Excel"], answer: "Clavier", explanation: "Le clavier est un composant physique, donc hardware." }
    ],

    koLink: { 
        url: "https://example.com/ko_m01_l02.pdf", 
        label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" 
    },
    mindMapUrl: null
},
            // M1S2L1
    'M1-sequence02-L1': {
    title: "Leçon 1 : Découverte de l'ordinateur : Rôles, familles et schéma fonctionnel",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",

    // ✅ OVERVIEW
    overview: "Cette leçon présente la définition d’un ordinateur, ses rôles fondamentaux, les différentes familles (des superordinateurs aux smartphones) et le schéma fonctionnel de base (Entrée, Traitement, Sortie, Stockage).",

    objectives: [
        "Définir ce qu'est un ordinateur.",
        "Identifier les différentes catégories d'ordinateurs (serveur, desktop, nano-ordinateur...).",
        "Expliquer le schéma fonctionnel de base (Entrée, Traitement, Sortie, Stockage)."
    ],

    successCriteria: [
        "Je peux nommer 3 types d'ordinateurs et leur usage principal.",
        "Je peux dessiner le schéma fonctionnel simple d'un ordinateur."
    ],

    // ✅ NOTES DE COURS DÉTAILLÉES
    detailedNotes: `
        <h4 class="text-xl font-bold text-teal-800 mb-3">1. Qu'est-ce qu'un ordinateur ?</h4>
        <p class="mb-4 text-gray-700">
        Un ordinateur est une machine électronique capable de <strong>traiter automatiquement des informations</strong> selon des instructions (programmes). Il reçoit des données en entrée, les transforme et fournit des résultats en sortie.
        </p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Caractéristiques :</strong> Rapidité, fiabilité, capacité de stockage, automatisation.</li>
            <li><strong>Rôle :</strong> Transformer des données en informations utiles.</li>
        </ul>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">2. Les familles d'ordinateurs</h4>
        <p class="mb-4 text-gray-700">Les ordinateurs se déclinent en plusieurs catégories :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Superordinateurs :</strong> Calculs scientifiques, prévisions climatiques.</li>
            <li><strong>Serveurs :</strong> Fourniture de services et stockage pour réseaux.</li>
            <li><strong>Ordinateurs de bureau :</strong> Usage personnel ou professionnel.</li>
            <li><strong>Portables :</strong> Mobilité et polyvalence.</li>
            <li><strong>Nano-ordinateurs :</strong> Projets spécifiques (ex : Raspberry Pi).</li>
            <li><strong>Smartphones/Tablettes :</strong> Communication et multimédia.</li>
        </ul>

        <h4 class="text-xl font-bold text-teal-800 mt-6 mb-3">3. Schéma fonctionnel de base</h4>
        <p class="mb-4 text-gray-700">Un ordinateur suit le cycle <strong>Entrée – Traitement – Sortie – Stockage</strong> :</p>
        <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
            <li><strong>Entrée :</strong> Données saisies via clavier, souris, capteurs.</li>
            <li><strong>Traitement :</strong> Exécution des instructions par le processeur (CPU).</li>
            <li><strong>Sortie :</strong> Résultat affiché (écran, imprimante, son).</li>
            <li><strong>Stockage :</strong> Conservation des données (disque dur, SSD, cloud).</li>
        </ul>
        <p class="mb-4 text-gray-700"><em>Exemple :</em> Saisie d’un texte → Traitement par le logiciel → Affichage sur l’écran → Sauvegarde sur le disque.</p>
    `,

    // ✅ RESSOURCES ET ACTIVITÉS
    resourcesAndActivities: [
        { type: "Worksheet", title: "Fiche : Les familles d'ordinateurs", objective: "Identifier les catégories et leurs usages", link: "fiche_familles_L1.pdf", icon: "document" },
        { type: "Exercice", title: "Dessiner le schéma fonctionnel d'un ordinateur", objective: "Compréhension du cycle Entrée-Traitement-Sortie", link: "exercice_schema_L1.pdf", icon: "document" },
        { type: "Tuto Vidéo", title: "Découverte des composants d'un ordinateur", objective: "Visualisation des rôles", link: "video_composants_L1.mp4", icon: "video" },
        { type: "Application", title: "Quiz interactif (App Web)", objective: "Auto-évaluation ludique", link: "#", icon: "app" }
    ],

    // ✅ QUIZ
    quiz: [
        { id: 1, question: "Quel est le rôle principal d'un ordinateur ?", options: ["Stocker des données", "Traiter automatiquement des informations", "Afficher des images"], answer: "Traiter automatiquement des informations", explanation: "Un ordinateur transforme des données en informations utiles grâce à des programmes." },
        { id: 2, question: "Donnez un exemple de nano-ordinateur :", options: ["Serveur", "Raspberry Pi", "Superordinateur"], answer: "Raspberry Pi", explanation: "Le Raspberry Pi est un nano-ordinateur utilisé pour des projets spécifiques." },
        { id: 3, question: "Quels sont les 4 éléments du schéma fonctionnel ?", options: ["Entrée, Sortie, Réseau, Stockage", "Entrée, Traitement, Sortie, Stockage", "Entrée, CPU, Sortie, Mémoire"], answer: "Entrée, Traitement, Sortie, Stockage", explanation: "C'est le cycle fondamental du fonctionnement d'un ordinateur." }
    ],

    koLink: { 
        url: "https://example.com/ko_m02_s01_l01.pdf", 
        label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" 
    },
    mindMapUrl: null
},

  'M1-sequence02-L2': { 
    title: "Leçon 2 : Au cœur du traitement : Le CPU et l'architecture Von Neumann",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",
    overview: "Plongée au cœur du 'cerveau' de l'ordinateur (CPU). Découverte de ses composants (UC, UAL) et du principe de Von Neumann qui explique comment il exécute un programme.",
    objectives: [
        "Expliquer le principe de l'architecture Von Neumann (données et instructions en mémoire).",
        "Distinguer une donnée d'une instruction.",
        "Identifier les composants du CPU (UC, UAL, registres, horloge, bus) et leur rôle."
    ],
    successCriteria: [
        "Je peux expliquer la différence entre l'Unité de Contrôle (UC) et l'Unité Arithmétique et Logique (UAL).",
        "Je peux expliquer pourquoi les instructions et les données sont toutes les deux dans la mémoire."
    ],
    resourcesAndActivities: [
    // Doit avoir "link", "title", "type", "objective", "icon"
    { 
        type: "Exercice PDF", 
        title: "Schéma vierge de Von Neumann à compléter", 
        objective: "Mémorisation visuelle", 
        link: "exercice_schema_M1S2L2.pdf", 
        icon: "pdf" 
    },
    { 
        type: "Vidéo Explicative", 
        title: "Vidéo : L'architecture de Von Neumann (5 min)", 
        objective: "Synthèse visuelle", 
        link: "https://www.youtube.com/watch?v=13F24qW1X-o", 
        icon: "video" 
    }
],
    quiz: [
    { 
        id: 8, 
        question: "Dans l'analogie de la recette de cuisine, les 'ingrédients' (ex: le nombre 5) correspondent à :", 
        options: ["Données", "Instructions", "CPU", "Bus"], 
        answer: "Données", 
        explanation: "Les données sont les informations brutes (ingrédients) que le CPU va traiter en suivant les instructions (la recette)." 
    },
    { 
        id: 9, 
        question: "Quelle est l'idée principale de l'architecture de Von Neumann ?", 
        options: ["Stocker les données et les instructions dans la même mémoire", "Avoir un CPU très rapide", "Utiliser un clavier et une souris", "Connecter l'ordinateur à Internet"], 
        answer: "Stocker les données et les instructions dans la même mémoire", 
        explanation: "L'architecture de Von Neumann utilise une mémoire unique pour le programme (instructions) et les informations (données)." 
    },
    { 
        id: 10, 
        question: "Quelle partie du CPU est la 'calculette' qui effectue les additions et les opérations logiques ?", 
        options: ["L'Unité de Commande (UC)", "L'Unité Arithmétique et Logique (UAL)", "La RAM", "Les Registres"], 
        answer: "L'Unité Arithmétique et Logique (UAL)", 
        explanation: "L'UAL (ou ALU en anglais) est le composant qui exécute tous les calculs arithmétiques et les comparaisons logiques." 
    },
    { 
        id: 11, 
        question: "Comment s'appelle la première étape du cycle d'exécution, où l'UC va chercher l'instruction dans la RAM ?", 
        options: ["Execute (Exécuter)", "Decode (Décoder)", "Fetch (Lire)", "Store (Stocker)"], 
        answer: "Fetch (Lire)", 
        explanation: "Le cycle est 'Fetch-Decode-Execute'. La première étape (Fetch) consiste à lire l'instruction depuis la mémoire." 
    },
    { 
        id: 12, 
        question: "Lequel de ces éléments est un périphérique d'ENTRÉE ?", 
        options: ["Écran", "Imprimante", "Haut-parleurs", "Souris"], 
        answer: "Souris", 
        explanation: "La souris envoie des données (clics, mouvements) à l'ordinateur, c'est donc un périphérique d'entrée. Les autres reçoivent des données." 
    }
],
    koLink: { url: "https://example.com/ko_m02_s01_l02.pdf", label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" },
    mindMapUrl: null, // Remis à 'null' selon vos indications
    detailedNotes: `
<div class="space-y-6 text-gray-800">
    <h2 class="text-2xl font-bold text-blue-800">Introduction</h2>
    <p>Aujourd'hui, nous allons regarder ce qu'il se passe à l'intérieur du "cerveau" de l'ordinateur : le <strong>Processeur (CPU)</strong>. Pour comprendre comment il fonctionne, nous devons d'abord comprendre le plan sur lequel il est construit : l'architecture de Von Neumann.</p>

    <h3 class="text-xl font-semibold text-blue-700 mt-6">1. Données vs. Instructions : Les deux langages de la machine</h3>
    <p>Un ordinateur manipule en permanence deux types d'information. Il est crucial de les distinguer.</p>
    <ul class="list-disc list-outside pl-6 space-y-2">
        <li>
            <strong>Une Donnée (Data) :</strong><br>
            C'est une information brute, passive. C'est l'objet sur lequel on travaille.
            <p class="text-sm text-gray-600 mt-1"><em>Exemples : Le nombre <code>10</code>, la lettre <code>'A'</code>, la couleur d'un pixel, votre score dans un jeu, le son d'une note de musique.</em></p>
        </li>
        <li>
            <strong>Une Instruction :</strong><br>
            C'est un <strong>ordre</strong> que la machine doit exécuter. C'est l'action que l'on fait sur les données.
            <p class="text-sm text-gray-600 mt-1"><em>Exemples : <code>ADDITIONNER</code>, <code>COMPARER</code>, <code>AFFICHER À L'ÉCRAN</code>, <code>LIRE UNE TOUCHE</code>.</em></p>
        </li>
    </ul>

    <div class="bg-blue-50 p-4 rounded-lg mt-4">
        <h4 class="font-semibold text-blue-800">Application concrète :</h4>
        <p class="mt-2">Imaginons un simple calcul : <code>5 + 2</code>.</p>
        <ul class="list-disc list-inside pl-4">
            <li><code>5</code> et <code>2</code> sont les <strong>données</strong>.</li>
            <li><code>+</code> (l'ordre d'additionner) est l'<strong>instruction</strong>.</li>
        </ul>
        <p class="mt-2">Dans un jeu vidéo :</p>
        <ul class="list-disc list-inside pl-4">
            <li><strong>Données :</strong> La position (X, Y) de votre personnage, vos points de vie (<code>100</code>).</li>
            <li><strong>Instructions :</strong> <code>SI</code> la touche "flèche droite" est pressée, <code>ALORS</code> <code>AJOUTER 1</code> à la donnée X. <code>SI</code> "points de vie" &lt; 1, <code>ALORS</code> <code>AFFICHER</code> l'image "Game Over".</li>
        </ul>
    </div>

    <h3 class="text-xl font-semibold text-blue-700 mt-6">2. Le Principe de l'Architecture de Von Neumann</h3>
    <p>L'idée géniale de John von Neumann (en 1945) a été de dire :</p>
    <blockquote class="border-l-4 border-blue-500 pl-4 py-2 italic my-4 bg-gray-50">
        <strong>"Pour être efficace, un ordinateur doit stocker les instructions (la recette) et les données (les ingrédients) au MÊME endroit : la Mémoire Centrale (RAM)."</strong>
    </blockquote>
    <p>Avant cela, les instructions étaient souvent stockées physiquement différemment des données. Cela rend l'ordinateur incroyablement <strong>flexible</strong>.</p>
    <div class="my-4 p-4 border rounded text-center text-gray-500 bg-gray-50">
        [Schéma illustrant le CPU et la Mémoire Centrale unique contenant Données et Instructions]
    </div>

    <h3 class="text-xl font-semibold text-blue-700 mt-6">3. Zoom sur le Cerveau : Le Processeur (CPU)</h3>
    <p>Le <strong>CPU (Central Processing Unit)</strong>, ou <strong>Processeur</strong>, est le composant qui exécute les instructions. Il est lui-même composé de plusieurs éléments clés.</p>
    <div class="my-4 p-4 border rounded text-center text-gray-500 bg-gray-50">
        [Schéma des composants internes du CPU : UC, UAL, Registres, Horloge, Bus]
    </div>
    <ul class="list-none space-y-4">
        <li>
            <strong class="text-blue-800">L'Unité de Commande (UC) :</strong><br>
            C'est le <strong>"chef d'orchestre"</strong> du CPU. Son rôle est de lire les instructions, les "décoder" (comprendre l'ordre) et d'envoyer des ordres à l'UAL et aux registres.
        </li>
        <li>
            <strong class="text-blue-800">L'Unité Arithmétique et Logique (UAL ou ALU) :</strong><br>
            C'est la <strong>"super-calculatrice"</strong> du CPU. Son rôle est d'exécuter tous les calculs (<code>+</code>, <code>-</code>) et les comparaisons logiques (<code>&gt;</code>, <code>==</code>) que l'UC lui demande.
        </li>
        <li>
            <strong class="text-blue-800">Les Registres :</strong><br>
            Ce sont des <strong>"mini-mémoires"</strong> ultra-rapides situées <em>à l'intérieur</em> même du CPU. Ils servent à stocker temporairement l'instruction en cours et les données du calcul (ex: <code>5</code> et <code>2</code>).
        </li>
        <li>
            <strong class="text-blue-800">L'Horloge (Clock) :</strong><br>
            C'est le <strong>"métronome"</strong>. Elle donne le rythme de travail au CPU en envoyant des "tops" (impulsions). La vitesse est mesurée en Hertz (Hz).
        </li>
        <li>
            <strong class="text-blue-800">Les Bus :</strong><br>
            Ce sont les <strong>"autoroutes de l'information"</strong>. Ce sont les fils qui relient tous les composants (CPU, RAM, etc.) et transportent les données et les ordres.
        </li>
    </ul>

    <div class="bg-blue-50 p-4 rounded-lg mt-4">
        <h4 class="font-semibold text-blue-800">Application : Comment le CPU calcule <code>5 + 2</code> ?</h4>
        <p>Voici les étapes simplifiées, au rythme de l'<strong>Horloge</strong> :</p>
        <ol class="list-decimal list-inside space-y-2 mt-2">
            <li>(Top 1) L'**UC** (le chef) demande l'instruction à la RAM (via le **Bus**).</li>
            <li>(Top 2) L'instruction "ADDITIONNER 5 et 2" arrive dans un **Registre** du CPU.</li>
            <li>(Top 3) L'**UC** décode l'instruction (elle comprend "addition").</li>
            <li>(Top 4) L'**UC** place les données <code>5</code> et <code>2</code> dans d'autres **Registres**.</li>
            <li>(Top 5) L'**UC** ordonne à l'**UAL** : "Additionne le contenu de ces deux cases !".</li>
            <li>(Top 6) L'**UAL** exécute le calcul. Le résultat <code>7</code> est placé dans un **Registre**.</li>
            <li>(Top 7) L'**UC** envoie le <code>7</code> (via le **Bus**) vers la mémoire RAM pour un usage futur.</li>
        </ol>
    </div>
</div>
`
  },




'M1-sequence02-L3': { 
    title: "Leçon 3 : Les Mémoires (Vive, Morte et de Masse)",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",
    overview: "Comprendre les différents types de mémoire et leur rôle. Distinction entre la mémoire de travail (RAM), la mémoire de démarrage (ROM) et le stockage permanent (SSD/HDD).",
    objectives: [
        "Distinguer RAM et ROM (rôle, volatilité).",
        "Différencier la mémoire vive (RAM) de la mémoire de masse (stockage).",
        "Comprendre la notion de hiérarchie des mémoires (vitesse vs capacité)."
    ],
    successCriteria: [
        "Je peux expliquer ce qui se passe dans la RAM quand j'ouvre un logiciel.",
        "Je peux expliquer pourquoi un ordinateur a besoin à la fois d'un SSD/HDD et de RAM."
    ],
    resourcesAndActivities: [], 
    quiz: [],
    koLink: { url: "https://example.com/ko_m02_s01_l03.pdf", label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" },
    mindMapUrl: null,
    detailedNotes: `<p class="text-gray-600">Les notes détaillées pour cette leçon sont en cours de rédaction. Revenez bientôt !</p>`
},

'M1-sequence02-L4': { 
    title: "Leçon 4 : Carte mère et périphériques",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",
    overview: "Identifier les composants qui connectent tout (carte mère, alimentation) et ceux qui permettent à l'ordinateur de communiquer avec l'utilisateur (périphériques d'entrée et de sortie).",
    objectives: [
        "Identifier le rôle de la carte mère.",
        "Classifier les périphériques (entrée, sortie, entrée/sortie).",
        "Identifier les autres composants vitaux (alimentation, carte réseau)."
    ],
    successCriteria: [
        "Je peux citer 3 périphériques d'entrée et 3 de sortie.",
        "Je peux expliquer que la carte mère sert à connecter tous les composants entre eux."
    ],
    resourcesAndActivities: [], 
    quiz: [],
    koLink: { url: "https://example.com/ko_m02_s01_l04.pdf", label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" },
    mindMapUrl: null,
    detailedNotes: `<p class="text-gray-600">Les notes détaillées pour cette leçon sont en cours de rédaction. Revenez bientôt !</p>`
},

'M1-sequence02-L5': { 
    title: "Leçon 5 : Synthèse et Spécifications Techniques",
    moduleTitle: "M01 : Généralités sur les Systèmes Informatiques",
    overview: "Cette leçon introduit la représentation de l’information en binaire, explique pourquoi les ordinateurs utilisent le système binaire, apprend aux apprenants à convertir des nombres binaires en décimaux et inversement, et se termine par une activité pratique pour identifier et comparer la taille des fichiers numériques (texte, image, audio, vidéo).",
    objectives: [
        "Identifier les spécifications clés (CPU, RAM, Stockage) sur une fiche technique.",
        "Mettre en relation un besoin (ex: 'Gamer') avec des composants spécifiques (ex: 'RAM élevée').",
        "Justifier le choix d'une configuration pour un utilisateur donné."
    ],
    successCriteria: [
        "Je peux lire une publicité pour un PC et identifier la quantité de RAM et le type de stockage.",
        "Je peux expliquer pourquoi un 'gamer' a besoin de composants différents d'un 'bureauticien'."
    ],
    resourcesAndActivities: [], 
    quiz: [],
    koLink: { url: "https://example.com/ko_m02_s01_l05.pdf", label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" },
    mindMapUrl: null,
    detailedNotes: `<p class="text-gray-600">Les notes détaillées pour cette leçon sont en cours de rédaction. Revenez bientôt !</p>`
},
            // M2S1L1
            'M2-sequence01-L1': { 
                title: "Leçon 1 : foncionnalités SE",
                moduleTitle: "M02 : Logiciels",
                overview: "Exploration des composants internes et de leur rôle dans l'architecture de Von Neumann.",
                objectives: ["Dessiner et étiqueter le schéma fonctionnel.", "Expliquer le rôle de l'UAL et de l'UC."],
                successCriteria: ["Je peux identifier 4 composants principaux de l'UC."],
                resourcesAndActivities: [], 
                quiz: [],
                koLink: { url: "https://example.com/ko_m01_l03.pdf", label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" },
                mindMapUrl: null, // Pas de carte mentale pour cette leçon
                detailedNotes: `<p class="text-gray-600">Les notes détaillées pour cette leçon sont en cours de rédaction. Revenez bientôt !</p>`
            },

            'M2-sequence01-L2': { 
                title: "Leçon 2 : Envirenoment SE",
                moduleTitle: "M02 : Logiciels",
                overview: "Exploration des composants internes et de leur rôle dans l'architecture de Von Neumann.",
                objectives: ["Dessiner et étiqueter le schéma fonctionnel.", "Expliquer le rôle de l'UAL et de l'UC."],
                successCriteria: ["Je peux identifier 4 composants principaux de l'UC."],
                resourcesAndActivities: [], 
                quiz: [],
                koLink: { url: "https://example.com/ko_m01_l03.pdf", label: "Télécharger l'Organisateur de Connaissances (KO - PDF)" },
                mindMapUrl: null, // Pas de carte mentale pour cette leçon
                detailedNotes: `<p class="text-gray-600">Les notes détaillées pour cette leçon sont en cours de rédaction. Revenez bientôt !</p>`
            }

        };

        // --- Fonctions de la Modale Carte Mentale (Maintenues mais inutilisées pour Leçon 1) ---
        window.closeMindMap = function() {
            document.getElementById('mindmap-modal').classList.add('hidden');
        }

        /**
         * Ouvre la carte mentale. Utilise l'URL externe si définie, sinon affiche une alerte.
         */
        window.openMindMap = function(lessonKey) {
            const mindMapUrl = lessonData[lessonKey]?.mindMapUrl;

            if (mindMapUrl) {
                // Ouvre le lien externe dans une nouvelle fenêtre
                window.open(mindMapUrl, '_blank');
            } else {
                // Utilisation d'un message non-critique pour respecter les contraintes
                console.log("Carte Mentale non disponible pour cette leçon.");
            }
        }

        /**
         * Gère la soumission simulée du formulaire de contact.
         */
        window.handleContactSubmit = function(event) {
            event.preventDefault();
            
            const formContainer = document.getElementById('contact-form-container');
            
            // Empêcher les soumissions multiples
            if (document.getElementById('success-message')) return; 

            // Création du message de succès
            const successMessage = document.createElement('div');
            successMessage.id = 'success-message';
            successMessage.className = 'mt-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded-lg text-center font-medium';
            successMessage.textContent = '✅ Message envoyé ! Je vous répondrai dans les plus brefs délais.';
            formContainer.appendChild(successMessage);
            
            // Vider les champs
            document.getElementById('contact-subject').value = '';
            document.getElementById('contact-message').value = '';

            // Retirer le message après 4 secondes
            setTimeout(() => {
                successMessage.remove();
            }, 4000);

            console.log("Simulated form submission successful.");
        }


        /**
         * Génère la page de cours détaillée à partir des données structurées.
         */
        function generateLessonPage(lessonKey) {
            const data = lessonData[lessonKey];
            if (!data) return `<div class="p-8 text-center text-gray-600">Leçon non trouvée : ${lessonKey}</div>`;

            // Fonction de vérification de réponse au quiz
            function checkAnswer(id, correctAnswer, explanation, isQCM) {
                const feedbackElement = document.getElementById(`feedback-${id}`);
                let isCorrect = false;
                let userAnswer = '';
                
                // Logique de vérification (inchangée)
                if (isQCM) {
                    const checkedRadio = document.querySelector(`input[name="q-${id}"]:checked`);
                    userAnswer = checkedRadio ? checkedRadio.value : '';
                    isCorrect = userAnswer === correctAnswer;
                } else {
                    const input = document.querySelector(`#input-q-${id}`);
                    userAnswer = input ? input.value.trim() : '';
                    isCorrect = userAnswer.toLowerCase() === correctAnswer.toLowerCase();
                }

                feedbackElement.classList.remove('hidden', 'text-green-600', 'text-red-600');
                
                if (isCorrect) {
                    feedbackElement.classList.add('text-green-600');
                    feedbackElement.innerHTML = `✅ Correct ! ${explanation}`;
                } else {
                    feedbackElement.classList.add('text-red-600');
                    feedbackElement.innerHTML = `❌ Incorrect. Réponse attendue : "${correctAnswer}". Explication : ${explanation}`;
                }
            }
            window.checkAnswer = checkAnswer; // Rendre la fonction accessible globalement

            // Fonction pour générer le contenu du quiz
            const quizHtml = data.quiz && data.quiz.length > 0 ? data.quiz.map(q => {
                const isQCM = q.options && q.options.length > 0;
                let answerDisplay = '';

                if (isQCM) {
                    answerDisplay = q.options.map((opt, index) => `
                        <div class="flex items-center mt-1">
                            <input type="radio" name="q-${q.id}" id="q-${q.id}-${index}" value="${opt}" class="mr-2 accent-teal-600">
                            <label for="q-${q.id}-${index}">${opt}</label>
                        </div>
                    `).join('');
                } else {
                    answerDisplay = `<input type="text" id="input-q-${q.id}" placeholder="Entrez votre réponse..." class="p-2 border rounded w-full mt-2 focus:ring-teal-500 focus:border-teal-500">`;
                }

                return `
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-200 mb-6">
                        <p class="font-semibold text-gray-800 mb-3">${q.id}. ${q.question}</p>
                        ${answerDisplay}
                        <div id="feedback-${q.id}" class="mt-3 text-sm font-medium hidden"></div>
                        <button onclick="checkAnswer(${q.id}, '${q.answer.replace(/'/g, "\\'")}', '${q.explanation.replace(/'/g, "\\'")}', ${isQCM})" 
                                class="mt-3 text-sm px-3 py-1 bg-teal-500 text-white rounded hover:bg-teal-600 transition">
                            Vérifier
                        </button>
                    </div>
                `;
            }).join('') : '<p class="text-gray-500">Pas de quiz pour cette leçon pour l\'instant.</p>';

            // LOGIQUE KO (Organisateur de Connaissances)
            const koLinkData = data.koLink;
            let knowledgeOrganizerHtml;

            if (koLinkData) {
                knowledgeOrganizerHtml = `
                    <p class="mb-4 text-gray-700">L'organisateur de connaissances (KO) est disponible au format PDF pour une consultation hors ligne. Cliquez sur le bouton ci-dessous pour le télécharger.</p>
                    <a href="${koLinkData.url}" target="_blank" class="w-full inline-flex justify-center items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition duration-150">
                        ${icons.pdf}
                        ${koLinkData.label}
                    </a>
                `;
            } else {
                knowledgeOrganizerHtml = `<p class="text-gray-500">Pas de KO disponible pour cette leçon.</p>`;
            }

            // LOGIQUE NOUVELLE SECTION : Ressources et Activités
            const resourcesHtml = data.resourcesAndActivities && data.resourcesAndActivities.length > 0 ? data.resourcesAndActivities.map(res => {
                const iconSvg = icons[res.icon] || icons.document;
                const linkTarget = res.link.startsWith('http') || res.link.endsWith('.pdf') ? '_blank' : '#';
                const linkElement = res.link.startsWith('#') 
                    ? `<span class="text-gray-600">${res.link.replace('#', '')}</span>`
                    : `<a href="${res.link}" target="${linkTarget}" class="font-semibold text-teal-600 hover:text-teal-800 transition duration-150 truncate">${res.link}</a>`;

                return `
                    <li class="grid grid-cols-1 md:grid-cols-12 gap-2 p-3 border-l-4 border-teal-300 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                        <div class="md:col-span-1 flex items-center space-x-2">
                           ${iconSvg}
                           <span class="font-bold text-sm text-gray-700">${res.type}</span>
                        </div>
                        <div class="md:col-span-6 text-gray-800">
                           ${res.title}
                        </div>
                        <div class="md:col-span-3 text-sm text-gray-600 italic">
                            ${res.objective}
                        </div>
                        <div class="md:col-span-2 text-sm text-right">
                           ${linkElement}
                        </div>
                    </li>
                `;
            }).join('') : '<p class="text-gray-500">Aucune ressource ou activité spécifique pour cette leçon pour l\'instant.</p>';

            // LOGIQUE CARTE MENTALE (pointe maintenant vers l'URL externe)
            const mindMapButtonHtml = data.mindMapUrl 
                ? `<button onclick="openMindMap('${lessonKey}')" class="w-full inline-flex justify-center items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150">
                        <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-3 h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.3-.873-2.886.6-2.188 1.961a1.532 1.532 0 01-.582 2.286c-1.56.38-1.56 2.6 0 2.98a1.532 1.532 0 01.582 2.286c-.873 1.3.6 2.886 1.961 2.188a1.532 1.532 0 012.286.582c.38 1.56 2.6 1.56 2.98 0a1.532 1.532 0 012.286-.582c1.3.873 2.886-.6 2.188-1.961a1.532 1.532 0 01.582-2.286c1.56-.38 1.56-2.6 0-2.98a1.532 1.532 0 01-.582-2.286c.873-1.3-.6-2.886-1.961-2.188a1.532 1.532 0 01-2.286-.582zM10 8a2 2 0 100 4 2 2 0 000-4z" clip-rule="evenodd" /></svg>
                        Ouvrir la Carte Mentale (Lien Externe)
                    </button>`
                : `<div class="w-full px-6 py-3 text-center bg-gray-300 text-gray-700 rounded-lg font-semibold shadow-md">🧠 Carte Mentale non disponible</div>`;
                
            // LOGIQUE POUR LES NOTES DÉTAILLÉES 
            const detailedNotesHtml = data.detailedNotes ? `
                <div class="bg-indigo-50 p-6 rounded-xl shadow-xl border border-indigo-200 border-l-8 border-indigo-500">
                    <details class="cursor-pointer">
                        <summary class="text-3xl font-extrabold text-indigo-800 hover:text-indigo-900 transition duration-150 py-1 flex items-center">
                            <!-- L'icône change de direction via le CSS .notes-summary-icon -->
                            <span class="notes-summary-icon mr-2">${icons.caret}</span>
                            <span>Notes de Cours Détaillées (Version Web)</span>
                        </summary>
                        <div class="mt-4 pt-4 border-t border-indigo-200">
                            ${data.detailedNotes}
                        </div>
                    </details>
                </div>
            ` : '';



            return `
                <!-- BOUTON DE RETOUR ARRIÈRE -->
                <button onclick="navigateTo('modules')" class="mb-6 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
                    ← Revenir aux Modules
                </button>
                
                <h1 class="text-4xl font-extrabold text-gray-800 mb-2">${data.moduleTitle}</h1>
                <h2 class="text-3xl font-bold gradient-theme bg-clip-text text-transparent mb-8">${data.title}</h2>
                
                <div class="space-y-10">
                    
                    <!-- 1. APERÇU -->
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-2xl font-bold text-teal-700 mb-4">Aperçu du cours</h3>
                        <p class="text-gray-700">${data.overview}</p>
                    </div>

                    <!-- 2. OBJECTIFS & CRITÈRES DE RÉUSSITE -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- 2.1. OBJECTIFS -->
                        <div class="bg-white p-6 rounded-xl shadow-lg lesson-section">
                            <h3 class="text-xl font-bold">Objectifs Pédagogiques</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-700">
                                ${data.objectives.map(obj => `<li>${obj}</li>`).join('')}
                            </ul>
                        </div>

                        <!-- 2.2. CRITÈRES DE RÉUSSITE -->
                        <div class="bg-white p-6 rounded-xl shadow-lg lesson-section" style="border-left-color: #20c997;">
                            <h3 class="text-xl font-bold" style="color: #20c997;">Critères de Réussite ("Je peux...")</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-700">
                                ${data.successCriteria.map(crit => `<li>${crit}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                    
                    <!-- 3. RESSOURCES ET ACTIVITÉS -->
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-2xl font-bold text-teal-700 mb-4 border-b pb-2">Ressources et Activités</h3>
                        <p class="text-gray-600 mb-4">Feuilles d'exercices, tutoriels, vidéos et applications interactives pour approfondir la leçon.</p>
                        <ul class="space-y-3">
                            ${resourcesHtml}
                        </ul>
                    </div>

                    <!-- 4. QUIZ FORMATIF -->
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-2xl font-bold text-teal-700 mb-4 border-b pb-2">Quiz Formatif</h3>
                        ${quizHtml}
                    </div>
                    
                    <!-- 5. NOTES DE COURS DÉTAILLÉES (MAINTENANT TRÈS VISIBLE) -->
                    ${detailedNotesHtml}

                    <!-- 6. KNOWLEDGE ORGANIZER & CARTE MENTALE -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- ORGANISATEUR DE CONNAISSANCES (KO) -->
                        <div class="bg-white p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-teal-700 mb-4 border-b pb-2">Organisateur de Connaissances (KO)</h3>
                            ${knowledgeOrganizerHtml}
                        </div>

                        <!-- CARTE MENTALE -->
                        <div class="bg-white p-6 rounded-xl shadow-lg flex flex-col justify-between">
                            <h3 class="text-2xl font-bold text-teal-700 mb-4 border-b pb-2">Visualisation de la Leçon (Carte Mentale)</h3>
                            <p class="text-gray-700 mb-4">Utilisez cet outil pour réviser et organiser visuellement les concepts clés de la leçon.</p>
                            ${mindMapButtonHtml}
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * Fonction utilitaire pour obtenir les classes basées sur le statut et l'ID du module.
         */
        function getModuleClasses(moduleId, status) {
            let colorClass, opacityClass, buttonClass, buttonText, buttonDisabled, statusTagClass;
            const isCurrent = status === "En cours";
            const isUpcoming = status === "À venir";
            const isCompleted = status === "Terminé";

            // 1. DÉFINITION DE LA COULEUR DU MODULE (Base)
            switch (moduleId) {
                case 1: colorClass = 'bg-module-m01'; break; // Bleu (Systèmes)
                case 2: colorClass = 'bg-module-m02'; break; // Vert (Logiciels)
                case 3: colorClass = 'bg-module-m03'; break; // Indigo (Prog)
                case 4: colorClass = 'bg-module-m04'; break; // Rouge (Réseaux)
                default: colorClass = 'bg-gray-500';
            }

            // 2. HIÉRARCHIE D'OPACITÉ ET DE BOUTON (Estompage)
            if (isCurrent) {
                opacityClass = 'module-card-active';
                buttonClass = 'bg-white text-gray-800 shadow-md hover:bg-gray-100';
                buttonText = 'Voir le module';
                buttonDisabled = false;
                statusTagClass = 'bg-white/30 text-white';
            } else if (isCompleted) {
                opacityClass = 'module-card-completed';
                buttonClass = 'bg-white/70 text-gray-800 hover:bg-white';
                buttonText = 'Revoir';
                buttonDisabled = false;
                statusTagClass = 'bg-white/30 text-white flex items-center space-x-1'; // Avec icône
            } else { // À venir
                opacityClass = 'module-card-upcoming';
                buttonClass = 'bg-gray-400 text-gray-700 cursor-not-allowed shadow-inner';
                buttonText = 'À venir';
                buttonDisabled = true;
                statusTagClass = 'bg-white/30 text-white';
            }
            
            // Le texte doit toujours être blanc pour un bon contraste avec les couleurs vives (même estompées)
            const headerClass = `${colorClass} text-white`;

            return { headerClass, opacityClass, statusTagClass, buttonClass, buttonText, buttonDisabled };
        }
        
        // --- Fonctions de Contenu des Pages (mise à jour de la page contact) ---
        const pageContent = {
            accueil: () => {
                // NOUVEAUX STATUTS COHÉRENTS
                const modulesForAccueil = [
                    { id: 1, title: "M01 : Généralités sur les Systèmes Informatiques", status: "En cours" },
                    { id: 2, title: "M02 : Les Logiciels", status: "À venir" },
                    { id: 3, title: "M03 : Algorithmique et Programmation", status: "À venir" },
                    { id: 4, title: "M04 : Réseaux et Internet", status: "À venir" },
                ];

                const moduleCardsHtml = modulesForAccueil.map(module => {
                    const { headerClass, opacityClass, statusTagClass, buttonClass, buttonText, buttonDisabled } = getModuleClasses(module.id, module.status);

                    // Contenu du statut pour la carte d'accueil
                    let statusContent = `<p class="text-sm font-light">${module.status}</p>`;

                    // Remplacement du texte du statut par une icône si "Terminé"
                    let moduleStatusDisplay = module.status;
                    if (module.status === "Terminé") {
                        // Utilise l'icône de succès (checkPro) définie au début du script
                        moduleStatusDisplay = `<div class="flex items-center space-x-1">${icons.checkPro} Terminé</div>`;
                    }
                    
                    return `
                        <div class="module-card p-6 rounded-xl shadow-lg ${headerClass} ${opacityClass}">
                            <div class="text-white">
                                <h3 class="text-xl font-extrabold mb-1">${module.title}</h3>
                                ${statusContent}
                            </div>
                            <!-- Bouton qui ne navigue que s'il n'est pas "À venir" -->
                            <a href="${buttonDisabled ? '#' : 'javascript:void(0)'}" 
                                onclick="${buttonDisabled ? '' : "navigateTo('modules')"}"
                                class="inline-block mt-4 px-6 py-2 rounded-lg font-semibold transition duration-300 ${buttonClass}">
                                ${buttonText}
                            </a>
                        </div>
                    `;
                }).join('');


                return `
                    <div class="hero-banner gradient-theme text-white p-8 sm:p-12 rounded-2xl shadow-xl mb-10 text-center">
                        <h1 class="text-4xl sm:text-5xl font-extrabold mb-2">Bienvenue sur CS-Lycée</h1>
                        <p class="text-lg opacity-90">Votre plateforme interactive pour maîtriser les bases de l'informatique.</p>
                    </div>

                    <div class="mb-10 p-6 bg-white rounded-xl shadow-md border-l-4 border-red-500">
                        <p class="text-red-700">IMPORTANT : Le projet 1 est à rendre avant le mercredi 12 Novembre. Consultez l'onglet "Devoirs" !</p>
                    </div>

                    <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Mes Modules</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        ${moduleCardsHtml}
                    </div>
                `;
            },

            modules: () => {
                // NOUVELLE STRUCTURE UTILISANT UNIQUEMENT LE STATUT POUR LA COULEUR
                const modulesStructure = [
                    { 
                        id: 1, 
                        title: "M01 : Généralités sur les Systèmes Informatiques", 
                        status: "En cours", 
                        sequences: [
                            { title: "Séquence 1 : Définitions et vocabulaire de base", lessons: [
                                { title: "Leçon 1 : Information, traitement et Informatique", href: "M1-sequence01-L1" },
                                { title: "Leçon 2 : Système informatique, Représentation de l'information", href: "M1-sequence01-L2" }
                            ]},
                            { title: "Séquence 2 : Structure de base d’un ordinateur", lessons: [
                                { title: "Leçon 1 : Découverte de l'ordinateur : Rôles, familles et schéma fonctionnel", href: "M1-sequence02-L1" },
                                { title: "Leçon 2 : Au cœur du traitement : Le CPU et l'architecture Von Neumann", href: "M1-sequence02-L2" },
                                { title: "Leçon 3 : Les Mémoires (Vive, Morte et de Masse)", href: "M1-sequence02-L3" },
                                { title: "Leçon 4 : Carte mère et périphériques", href: "M1-sequence02-L4" },
                                { title: "Leçon 5 : Synthèse et Spécifications Techniques", href: "M1-sequence02-L5" },
                            ]},
                            { title: "Séquence 3 : Type de logiciels et dommaine d'application", lessons: [
                                { title: "Leçon 1 : Type de logiciels", href: "M1-sequence03-L1" },
                                { title: "Leçon 2 : Projet 01( voir Devoirs & Projets)", href: "M1-sequence03-L2" }
                            ]}
                        ]
                    },
                    { 
                        id: 2, 
                        title: "M02 : Les Logiciels", 
                        status: "À venir", 
                        sequences: [
                            { title: "Séquence 1 : Système d’exploitation", lessons: [
                                { title: "Leçon 1 : Fonctionnalités de base d’un système d’exploitation", href: "M2-sequence01-L1" },
                                { title: "Leçon 2 : Environnement d’un système d’exploitation", href: "M2-sequence01-L2" },
                                { title: "Leçon 3 : Gestion des fichiers et dossiers", href: "M2-sequence01-L3" }
                            ]},
                            { title: "Séquence 2 : Traitement de texte", lessons: [
                                { title: "Leçon 1 : Interface et outils de base", href: "M2-sequence02-L1" },
                                { title: "Leçon 2 : Élaboration d’un document", href: "M2-sequence02-L2" }
                            ]},
                            { title: "Séquence 3 : Tableur", lessons: [
                                { title: "Leçon 1 : Fonctionnalités d’un tableur", href: "M2-sequence03-L1" },
                                { title: "Leçon 2 : Création de tableaux", href: "M2-sequence02-S3-L2" },
                                { title: "Leçon 3 : Réalisation de graphiques", href: "M2-sequence03-L3" }
                            ]}
                        ]
                    },
                    { 
                        id: 3, 
                        title: "M03 : Algorithmique et Programmation", 
                        status: "À venir", 
                        sequences: [
                            { title: "Séquence 1 : Algorithme et structures de contrôle", lessons: [
                                { title: "Leçon 1 : Notion d’algorithme", href: "sequence01-L1" },
                                { title: "Leçon 2 : Instructions de base", href: "sequence01-L2" },
                                { title: "Leçon 3 : Structures de contrôle (conditionnelles et répétitives)", href: "sequence01-L3" }
                            ]},
                            { title: "Séquence 2 : Langage de programmation", lessons: [
                                { title: "Leçon 1 : Notion de programme", href: "sequence02-L1" },
                                { title: "Leçon 2 : Langages de programmation", href: "sequence02-L2" },
                                { title: "Leçon 3 : Transcription d’un algorithme en code", href: "sequence02-L3" }
                            ]}
                        ]
                    },
                    { 
                        id: 4, 
                        title: "M04 : Réseaux et Internet", 
                        status: "À venir", 
                        sequences: [
                            { title: "Séquence 1 : Notion de réseau informatique", lessons: [
                                { title: "Leçon 1 : Définition et utilité d’un réseau", href: "sequence04-S1-L1" },
                                { title: "Leçon 2 : Typologie des réseaux", href: "sequence04-S1-L2" },
                                { title: "Leçon 3 : Topologies des réseaux", href: "sequence04-S1-L3" }
                            ]},
                            { title: "Séquence 2 : Réseau Internet", lessons: [
                                { title: "Leçon 1 : Définition d’Internet", href: "sequence04-S2-L1" },
                                { title: "Leçon 2 : Services Internet (Web, e-mail, chat pédagogique)", href: "sequence04-S2-L2" },
                                { title: "Leçon 3 : Avantages et inconvénients d’Internet", href: "sequence04-S2-L3" }
                            ]}
                        ]
                    }
                ];

                return modulesStructure.map(module => {
                    const { headerClass, opacityClass, statusTagClass } = getModuleClasses(module.id, module.status);

                    const sequencesHtml = module.sequences.map(seq => `
                        <div class="mb-4 pt-3 border-t border-gray-100">
                            <h4 class="sequence-heading text-lg font-semibold text-gray-800 mb-2 p-1 rounded bg-gray-100">${seq.title}</h4>
                            <ul class="space-y-1 pl-4 text-gray-700">
                                ${seq.lessons.map(lesson => {
                                    // Les leçons d'un module "À venir" sont désactivées.
                                    const isDisabled = module.status !== "En cours" && module.status !== "Terminé";
                                    const linkClass = isDisabled ? 'text-gray-500 cursor-not-allowed' : 'text-gray-700 hover:text-teal-600';
                                    
                                    // CORRECTION : Utilisation de javascript:void(0) pour éviter le rechargement de la page 
                                    // et s'assurer que l'action onclick est bien appelée.
                                    const linkAction = isDisabled ? 'javascript:void(0)' : `MapsTo('${lesson.href}')`;
                                    
                                    return `
                                        <li class="pl-2 border-l-2 border-gray-300 hover:bg-gray-50 rounded">
                                            <a href="#" onclick="${linkAction}" class="block py-1 text-sm ${linkClass}">
                                                ${lesson.title}
                                            </a>
                                        </li>
                                    `;
                                }).join('')}
                            </ul>
                        </div>
                    `).join('');
                    
                    // Contenu du statut
                    let statusIconText = module.status;
                    if (module.status === "Terminé") {
                        statusIconText = `${icons.checkPro} Terminé`;
                    }

                    // Définir M01 (id=1) comme étant le module par défaut à déplier (car il est "En cours")
                    const isM1Active = module.id === 1;


                    return `
                        <div class="info-card module-card bg-white rounded-xl shadow-lg mb-6 ${!isM1Active ? 'collapsed' : ''} ${opacityClass}" id="module-${module.id}">
                            <div 
                                class="card-header ${headerClass} p-4 rounded-t-xl flex justify-between items-center cursor-pointer"
                                onclick="toggleModule(${module.id})"
                            >
                                <h3 class="text-xl font-extrabold text-white">${module.title}</h3>
                                <div class="flex items-center space-x-2">
                                    <span class="status-tag ${statusTagClass} text-xs font-semibold px-3 py-1 rounded-full text-white">${statusIconText}</span>
                                    <span class="toggle-icon text-lg text-white">${isM1Active ? '▼' : '▶'}</span>
                                </div>
                            </div>
                            <div class="card-body p-4 pt-0">
                                ${sequencesHtml}
                            </div>
                        </div>
                    `;
                }).join('');
            },

            // Remplacement des anciennes pages de séquence par un appel à la fonction générique
            'M1-sequence01-L1': () => generateLessonPage('M1-sequence01-L1'),
            'M1-sequence01-L2': () => generateLessonPage('M1-sequence01-L2'),
            'M1-sequence02-L1': () => generateLessonPage('M1-sequence02-L1'),
            'M1-sequence02-L2': () => generateLessonPage('M1-sequence02-L2'),
            'M1-sequence02-L3': () => generateLessonPage('M1-sequence02-L3'),
            'M1-sequence02-L4': () => generateLessonPage('M1-sequence02-L4'),
            'M1-sequence02-L5': () => generateLessonPage('M1-sequence02-L5'),
            'M2-sequence01-L1': () => generateLessonPage('M2-sequence01-L1'),
            'M2-sequence02-L2': () => generateLessonPage('M2-sequence01-L2'),
            'M2-sequence02-S1-L3': () => `<div class="p-8 text-center text-gray-600">Contenu pour M02-S01-L03 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence02-S2-L1': () => `<div class="p-8 text-center text-gray-600">Contenu pour M02-S02-L01 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence02-S2-L2': () => `<div class="p-8 text-center text-gray-600">Contenu pour M02-S02-L02 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence02-S3-L1': () => `<div class="p-8 text-center text-gray-600">Contenu pour M02-S03-L01 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence02-S3-L2': () => `<div class="p-8 text-center text-gray-600">Contenu pour M02-S03-L02 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence02-S3-L3': () => `<div class="p-8 text-center text-gray-600">Contenu pour M02-S03-L03 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence03-S1-L1': () => `<div class="p-8 text-center text-gray-600">Contenu pour M03-S01-L01 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence03-S1-L2': () => `<div class="p-8 text-center text-gray-600">Contenu pour M03-S01-L02 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence03-S1-L3': () => `<div class="p-8 text-center text-gray-600">Contenu pour M03-S01-L03 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence03-S2-L1': () => `<div class="p-8 text-center text-gray-600">Contenu pour M03-S02-L01 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence03-S2-L2': () => `<div class="p-8 text-center text-gray-600">Contenu pour M03-S02-L02 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence03-S2-L3': () => `<div class="p-8 text-center text-gray-600">Contenu pour M03-S02-L03 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence04-S1-L1': () => `<div class="p-8 text-center text-gray-600">Contenu pour M04-S01-L01 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence04-S1-L2': () => `<div class="p-8 text-center text-gray-600">Contenu pour M04-S01-L02 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence04-S1-L3': () => `<div class="p-8 text-center text-gray-600">Contenu pour M04-S01-L03 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence04-S2-L1': () => `<div class="p-8 text-center text-gray-600">Contenu pour M04-S02-L01 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence04-S2-L2': () => `<div class="p-8 text-center text-gray-600">Contenu pour M04-S02-L02 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,
            'sequence04-S2-L3': () => `<div class="p-8 text-center text-gray-600">Contenu pour M04-S02-L03 à venir... <button onclick="navigateTo('modules')" class="text-teal-600 hover:underline">Retour aux modules</button></div>`,

            devoirs: () => `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Mes Devoirs & Projets</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h3 class="text-xl font-bold text-red-600 mb-3">Projet 1: Recherche sur Histoire de l'Informatique</h3>
                    <p class="text-gray-700 mb-4"> Réaliser un projet de recherche permettant de comprendre l’évolution de 
l’informatique, ses inventeurs, ses grandes étapes et son impact sur la société.</p>
                      <p mb-4>  <a href="./PROJET01.pdf#toolbar=0" class="font-semibold text-gray-800 hover:text-teal-600">Fiche Projet</a></p>
                    <p class="text-sm font-semibold text-red-500">Date limite: Mercredi 12 Novembre (18:00)</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6 opacity-70">
                    <h3 class="text-xl font-bold text-gray-500 mb-3">Devoir 2: Structure Binaire</h3>
                    <p class="text-gray-500 mb-4">Conversion de nombres décimaux en binaire (exercices).</p>
                    <p class="text-sm font-semibold text-gray-400">Statut: Non disponible</p>
                </div>
            `,

            ressources: () => `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Ressources Pédagogiques</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h3 class="text-2xl font-bold text-teal-700 mb-4">Ressources Générales</h3>
                    <ul class="space-y-3">
                        <li class="p-3 border-l-4 border-teal-300 bg-gray-50 rounded-lg">
                            <a href="#" class="font-semibold text-gray-800 hover:text-teal-600">Lexique des termes informatiques</a> - Définitions clés pour tous les modules.
                        </li>
                        <li class="p-3 border-l-4 border-teal-300 bg-gray-50 rounded-lg">
                            <a href="#" class="font-semibold text-gray-800 hover:text-teal-600">Guide de préparation aux examens (PDF)</a> - Méthodes et conseils.
                        </li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-bold text-blue-700 mb-4">Ressources par Module</h3>
                    <ul class="space-y-3">
                        <li class="p-3 border-l-4 border-blue-300 bg-gray-50 rounded-lg">
                            <span class="font-bold text-blue-800">M01 (Systèmes) :</span> Vidéo explicative sur le rôle de la RAM.
                        </li>
                        <li class="p-3 border-l-4 border-blue-300 bg-gray-50 rounded-lg">
                            <span class="font-bold text-blue-800">M03 (Algorithmique) :</span> Exercices interactifs sur les boucles 'Pour' et 'Tant que'.
                        </li>
                    </ul>
                </div>
            `,
            
            calendrier: () => `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Calendrier des Événements</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-bold text-teal-700 mb-4">Prochains Événements</h3>
                    <div class="space-y-4">
                        <div class="p-4 border-l-4 border-red-500 bg-red-50 rounded-lg flex justify-between items-center">
                            <div>
                                <h4 class="font-bold text-red-800">Date limite : Projet 1</h4>
                                <p class="text-sm text-red-600">M01 - Recherche sur l'histoire de l'informatique</p>
                            </div>
                            <span class="font-extrabold text-red-700">12 Novembre</span>
                        </div>
                        <div class="p-4 border-l-4 border-teal-500 bg-teal-50 rounded-lg flex justify-between items-center">
                            <div>
                                <h4 class="font-bold text-teal-800">Evaluation Ecrit N°1 </h4>
                                <p class="text-sm text-teal-600">M01 </p>
                            </div>
                            <span class="font-extrabold text-teal-700">14 Novembre</span>
                        </div>
                        <div class="p-4 border-l-4 border-gray-500 bg-gray-50 rounded-lg flex justify-between items-center opacity-70">
                            <div>
                                <h4 class="font-bold text-gray-800">Lancement du Module M02</h4>
                                <p class="text-sm text-gray-600">M02 - Logiciels</p>
                            </div>
                            <span class="font-extrabold text-gray-700">19 Novembre</span>
                        </div>
                    </div>
                </div>
            `,

            contact: () => `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Contacter l'Enseignant</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                    <!-- Section de Profil et Contact -->
                    <div class="flex flex-col items-center text-center md:flex-row md:text-left md:items-start mb-8 border-b pb-6">
                        <!-- Photo Circulaire -->
                        <img src="${TEACHER_PHOTO_URL}" onerror="this.onerror=null; this.src='https://placehold.co/128x128/17a2b8/ffffff?text=Prof+Image'" alt="Photo de l'enseignant" class="w-32 h-32 rounded-full object-cover shadow-xl mb-4 md:mb-0 md:mr-6 border-4 border-teal-500">
                        
                        <!-- Info de Contact -->
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800">Younes TICHOUA</h3>
                            <p class="text-gray-600 mb-2">Professeur d'Informatique</p>
                            <p class="text-lg font-semibold text-teal-700">Email: <a href="mailto:votre.email@ecole.com" class="hover:underline">votre.email@ecole.com</a></p>
                            <p class="text-sm text-gray-500 mt-2">Je m'efforce de répondre à vos courriels dans les 24 heures durant les jours de semaine.</p>
                        </div>
                    </div>
                    
                    <!-- Formulaire de Question Rapide (Formulaire Circulaire) -->
                    <div id="contact-form-container" class="bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200">
                        <h3 class="text-xl font-bold text-teal-700 mb-4">Envoyer une Question Rapide</h3>
                        <form onsubmit="handleContactSubmit(event)" class="space-y-4">
                            <div>
                                <label for="contact-subject" class="block text-sm font-medium text-gray-700">Sujet:</label>
                                <input type="text" id="contact-subject" placeholder="Ex: Problème avec le Quiz L1" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 focus:border-teal-500 focus:ring-teal-500">
                            </div>
                            <div>
                                <label for="contact-message" class="block text-sm font-medium text-gray-700">Votre Message:</label>
                                <textarea id="contact-message" rows="4" placeholder="Tapez votre question détaillée ici..." required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 focus:border-teal-500 focus:ring-teal-500"></textarea>
                            </div>
                            <button type="submit" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white gradient-theme hover:opacity-90 transition">
                                Envoyer le Message
                            </button>
                        </form>
                    </div>

                </div>
            `,
        };


        // --- Fonctions de Navigation et d'Initialisation ---

        // Met à jour la classe active dans la barre de navigation
                // MODIFICATION : Mise à jour de la fonction updateNav pour gérer les liens mobiles
        function updateNav(activeId) {
            const finalId = activeId.includes('sequence') ? 'modules' : activeId;
            
            // Définir les classes pour les états actif/inactif
            const desktopActiveClasses = ['text-teal-700', 'font-extrabold', 'border-b-2', 'border-teal-700'];
            const desktopInactiveClasses = ['text-gray-700', 'font-medium'];
            
            const mobileActiveClasses = ['bg-teal-50', 'text-teal-800', 'font-bold'];
            const mobileInactiveClasses = ['text-gray-700', 'font-medium'];

            // Mettre à jour les liens Desktop
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove(...desktopActiveClasses);
                link.classList.add(...desktopInactiveClasses);
                
                if (link.id === `nav-${finalId}`) {
                    link.classList.remove(...desktopInactiveClasses);
                    link.classList.add(...desktopActiveClasses);
                }
            });

            // Mettre à jour les liens Mobile
            document.querySelectorAll('#mobile-menu a').forEach(link => {
                link.classList.remove(...mobileActiveClasses);
                link.classList.add(...mobileInactiveClasses);
                
                if (link.id === `mobile-nav-${finalId}`) {
                    link.classList.remove(...mobileInactiveClasses);
                    link.classList.add(...mobileActiveClasses);
                }
            });
        }

        // Fonction pour basculer l'état (déplié/replié) des modules dans la page modules
        function toggleModule(id) {
            const card = document.getElementById(`module-${id}`);
            if (card) {
                const isCollapsed = card.classList.toggle('collapsed');
                const icon = card.querySelector('.toggle-icon');
                if (icon) {
                    icon.innerHTML = isCollapsed ? '▶' : '▼';
                }
            }
        }
        
        // Navigation principale
        function navigateTo(pageName) {
            currentView = pageName;
            const container = document.getElementById('page-content-container');
            const contentGenerator = pageContent[pageName];

            if (contentGenerator) {
                container.innerHTML = contentGenerator();
            } else {
                if (lessonData[pageName]) {
                    container.innerHTML = generateLessonPage(pageName);
                } else {
                    container.innerHTML = `<div class="text-center p-12 text-gray-500">Page non trouvée : ${pageName}</div>`;
                }
            }

            updateNav(pageName);
            
            if (pageName === 'modules') {
                setTimeout(() => {
                    // Logique pour ouvrir M01 par défaut (le module "En cours")
                    const modulesToOpen = ['M01 : Généralités sur les Systèmes Informatiques']; 
                    
                    const moduleCards = document.querySelectorAll('.info-card');
                    moduleCards.forEach(card => {
                        const header = card.querySelector('.card-header h3');
                        const icon = card.querySelector('.toggle-icon');
                        
                        if (header && icon) {
                            if (modulesToOpen.some(title => header.textContent.includes(title))) {
                                card.classList.remove('collapsed');
                                icon.innerHTML = '▼';
                            } else {
                                card.classList.add('collapsed');
                                icon.innerHTML = '▶';
                            }
                        }
                    });
                }, 50); 
            }

            window.scrollTo(0, 0);
        }

        // CORRECTION DE L'ERREUR : Ajout de la fonction MapsTo pour qu'elle soit définie.
        // Elle agit comme un alias pour navigateTo, assurant que le code fonctionne 
        // même si l'utilisateur appelle accidentellement MapsTo.
        /**
         * Alias pour navigateTo pour corriger le ReferenceError.
         * @param {string} pageName - Le nom de la page ou de la leçon à afficher.
         */
        window.MapsTo = function(pageName) {
            console.warn("MapsTo() est obsolète. Utilisez navigateTo() à la place.");
            navigateTo(pageName);
        }
        // AJOUT : Fonction pour basculer le menu mobile (hamburger)
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const button = document.getElementById('mobile-menu-button');
            const iconOpen = button.querySelector('svg.block');
            const iconClose = button.querySelector('svg.hidden');

            const isHidden = menu.classList.toggle('hidden');
            
            // Basculer les icônes
            iconOpen.classList.toggle('hidden', !isHidden);
            iconClose.classList.toggle('hidden', isHidden);

            // Mettre à jour l'accessibilité
            button.setAttribute('aria-expanded', !isHidden);
        }
        
        // AJOUT : Fonction de navigation pour les liens mobiles (ferme le menu après clic)
        function mobileNavigateTo(pageName) {
            navigateTo(pageName); // Navigation normale
            
            // Fermer le menu
            const menu = document.getElementById('mobile-menu');
            const button = document.getElementById('mobile-menu-button');
            const iconOpen = button.querySelector('svg.block');
            const iconClose = button.querySelector('svg.hidden');
            
            menu.classList.add('hidden'); // Forcer la fermeture
            iconOpen.classList.remove('hidden'); // Afficher l'icône hamburger
            iconClose.classList.add('hidden'); // Cacher l'icône 'X'
            button.setAttribute('aria-expanded', 'false');
        }
        window.mobileNavigateTo = mobileNavigateTo; // Rendre globale pour onclick
        // --- Initialisation au Chargement de la Page ---
        // MODIFICATION : Ajout de l'écouteur d'événement pour le bouton mobile
        window.onload = () => {
            navigateTo(currentView);
            
            const userIdDisplay = document.querySelector('footer p:first-child');
            if (userIdDisplay) {
                // Ajout de l'ID utilisateur
                userIdDisplay.innerHTML += ` | ID: <span class="font-mono">${appId}</span>`;
            }

            // AJOUT : Écouteur d'événement pour le bouton du menu mobile
            document.getElementById('mobile-menu-button').addEventListener('click', toggleMobileMenu);
        };
        // Rendre la fonction accessible globalement pour le bouton dans le HTML
        window.toggleModule = toggleModule; 
    </script>
</body>
</html>
